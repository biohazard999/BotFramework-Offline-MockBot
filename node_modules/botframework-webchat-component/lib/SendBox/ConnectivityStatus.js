"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _Localize = require("../Localization/Localize");

var _connectToWebChat = _interopRequireDefault(require("../connectToWebChat"));

var _ErrorNotificationIcon = _interopRequireDefault(require("../Attachment/Assets/ErrorNotificationIcon"));

var _SpinnerAnimation = _interopRequireDefault(require("../Attachment/Assets/SpinnerAnimation"));

var _WarningNotificationIcon = _interopRequireDefault(require("../Attachment/Assets/WarningNotificationIcon"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

var CONNECTIVITY_STATUS_DEBOUNCE = 400;

var DebouncedConnectivityStatus =
/*#__PURE__*/
function (_React$Component) {
  _inherits(DebouncedConnectivityStatus, _React$Component);

  function DebouncedConnectivityStatus(props) {
    var _this;

    _classCallCheck(this, DebouncedConnectivityStatus);

    _this = _possibleConstructorReturn(this, _getPrototypeOf(DebouncedConnectivityStatus).call(this, props));
    _this.state = {
      children: props.children,
      since: Date.now()
    };
    return _this;
  }

  _createClass(DebouncedConnectivityStatus, [{
    key: "componentWillReceiveProps",
    value: function componentWillReceiveProps(nextProps) {
      var _this2 = this;

      var _this$props = this.props,
          children = _this$props.children,
          interval = _this$props.interval;
      var nextChildren = nextProps.children,
          nextInterval = nextProps.interval;
      var since = this.state.since;

      if (nextChildren !== children || nextInterval !== interval) {
        clearTimeout(this.timeout);
        this.timeout = setTimeout(function () {
          _this2.setState(function () {
            return {
              children: nextChildren,
              since: Date.now()
            };
          });
        }, Math.max(0, nextInterval - Date.now() + since));
      }
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      clearTimeout(this.timeout);
    }
  }, {
    key: "render",
    value: function render() {
      var children = this.state.children;
      return typeof children === 'function' ? children() : false;
    }
  }]);

  return DebouncedConnectivityStatus;
}(_react.default.Component);

DebouncedConnectivityStatus.defaultProps = {
  children: undefined
};
DebouncedConnectivityStatus.propTypes = {
  children: _propTypes.default.any,
  interval: _propTypes.default.number.isRequired
};

var connectConnectivityStatus = function connectConnectivityStatus() {
  for (var _len = arguments.length, selectors = new Array(_len), _key = 0; _key < _len; _key++) {
    selectors[_key] = arguments[_key];
  }

  return _connectToWebChat.default.apply(void 0, [function (_ref) {
    var connectivityStatus = _ref.connectivityStatus,
        language = _ref.language;
    return {
      connectivityStatus: connectivityStatus,
      language: language
    };
  }].concat(selectors));
};

var ConnectivityStatus = function ConnectivityStatus(_ref2) {
  var connectivityStatus = _ref2.connectivityStatus,
      language = _ref2.language,
      styleSet = _ref2.styleSet;
  return _react.default.createElement("div", {
    "aria-live": "polite",
    role: "status"
  }, _react.default.createElement(DebouncedConnectivityStatus, {
    interval: connectivityStatus === 'uninitialized' || connectivityStatus === 'error' ? 0 : CONNECTIVITY_STATUS_DEBOUNCE
  }, function () {
    return connectivityStatus === 'connectingslow' ? _react.default.createElement("div", {
      className: styleSet.warningNotification
    }, _react.default.createElement(_WarningNotificationIcon.default, null), (0, _Localize.localize)('SLOW_CONNECTION_NOTIFICATION', language)) : connectivityStatus === 'error' || connectivityStatus === 'notconnected' ? _react.default.createElement("div", {
      className: styleSet.errorNotification
    }, _react.default.createElement(_ErrorNotificationIcon.default, null), (0, _Localize.localize)('FAILED_CONNECTION_NOTIFICATION', language)) : connectivityStatus === 'uninitialized' ? _react.default.createElement("div", {
      className: styleSet.connectivityNotification
    }, _react.default.createElement(_SpinnerAnimation.default, null), (0, _Localize.localize)('INITIAL_CONNECTION_NOTIFICATION', language)) : connectivityStatus === 'reconnecting' ? _react.default.createElement("div", {
      className: styleSet.connectivityNotification
    }, _react.default.createElement(_SpinnerAnimation.default, null), (0, _Localize.localize)('INTERRUPTED_CONNECTION_NOTIFICATION', language)) : connectivityStatus === 'sagaerror' ? _react.default.createElement("div", {
      className: styleSet.errorNotification
    }, _react.default.createElement(_ErrorNotificationIcon.default, null), (0, _Localize.localize)('RENDER_ERROR_NOTIFICATION', language)) : connectivityStatus === 'reconnected' || connectivityStatus === 'connected' && false;
  }));
};

ConnectivityStatus.propTypes = {
  connectivityStatus: _propTypes.default.string.isRequired,
  language: _propTypes.default.string.isRequired,
  styleSet: _propTypes.default.shape({
    connectivityNotification: _propTypes.default.any.isRequired,
    errorNotification: _propTypes.default.any.isRequired,
    warningNotification: _propTypes.default.any.isRequired
  }).isRequired
};

var _default = connectConnectivityStatus(function (_ref3) {
  var styleSet = _ref3.styleSet;
  return {
    styleSet: styleSet
  };
})(ConnectivityStatus);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9TZW5kQm94L0Nvbm5lY3Rpdml0eVN0YXR1cy5qcyJdLCJuYW1lcyI6WyJDT05ORUNUSVZJVFlfU1RBVFVTX0RFQk9VTkNFIiwiRGVib3VuY2VkQ29ubmVjdGl2aXR5U3RhdHVzIiwicHJvcHMiLCJzdGF0ZSIsImNoaWxkcmVuIiwic2luY2UiLCJEYXRlIiwibm93IiwibmV4dFByb3BzIiwiaW50ZXJ2YWwiLCJuZXh0Q2hpbGRyZW4iLCJuZXh0SW50ZXJ2YWwiLCJjbGVhclRpbWVvdXQiLCJ0aW1lb3V0Iiwic2V0VGltZW91dCIsInNldFN0YXRlIiwiTWF0aCIsIm1heCIsIlJlYWN0IiwiQ29tcG9uZW50IiwiZGVmYXVsdFByb3BzIiwidW5kZWZpbmVkIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwiYW55IiwibnVtYmVyIiwiaXNSZXF1aXJlZCIsImNvbm5lY3RDb25uZWN0aXZpdHlTdGF0dXMiLCJzZWxlY3RvcnMiLCJjb25uZWN0VG9XZWJDaGF0IiwiY29ubmVjdGl2aXR5U3RhdHVzIiwibGFuZ3VhZ2UiLCJDb25uZWN0aXZpdHlTdGF0dXMiLCJzdHlsZVNldCIsIndhcm5pbmdOb3RpZmljYXRpb24iLCJlcnJvck5vdGlmaWNhdGlvbiIsImNvbm5lY3Rpdml0eU5vdGlmaWNhdGlvbiIsInN0cmluZyIsInNoYXBlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxJQUFNQSw0QkFBNEIsR0FBRyxHQUFyQzs7SUFFTUMsMkI7Ozs7O0FBQ0osdUNBQVlDLEtBQVosRUFBbUI7QUFBQTs7QUFBQTs7QUFDakIscUdBQU1BLEtBQU47QUFFQSxVQUFLQyxLQUFMLEdBQWE7QUFDWEMsTUFBQUEsUUFBUSxFQUFFRixLQUFLLENBQUNFLFFBREw7QUFFWEMsTUFBQUEsS0FBSyxFQUFFQyxJQUFJLENBQUNDLEdBQUw7QUFGSSxLQUFiO0FBSGlC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QUFQMEIsQ0FBL0I7O2VBVWVDLHlCQUF5QixDQUFDO0FBQUEsTUFBR00sUUFBSCxTQUFHQSxRQUFIO0FBQUEsU0FBbUI7QUFBRUEsSUFBQUEsUUFBUSxFQUFSQTtBQUFGLEdBQW5CO0FBQUEsQ0FBRCxDQUF6QixDQUE0REQsa0JBQTVELEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IHsgbG9jYWxpemUgfSBmcm9tICcuLi9Mb2NhbGl6YXRpb24vTG9jYWxpemUnO1xuaW1wb3J0IGNvbm5lY3RUb1dlYkNoYXQgZnJvbSAnLi4vY29ubmVjdFRvV2ViQ2hhdCc7XG5pbXBvcnQgRXJyb3JOb3RpZmljYXRpb25JY29uIGZyb20gJy4uL0F0dGFjaG1lbnQvQXNzZXRzL0Vycm9yTm90aWZpY2F0aW9uSWNvbic7XG5pbXBvcnQgU3Bpbm5lckFuaW1hdGlvbiBmcm9tICcuLi9BdHRhY2htZW50L0Fzc2V0cy9TcGlubmVyQW5pbWF0aW9uJztcbmltcG9ydCBXYXJuaW5nTm90aWZpY2F0aW9uSWNvbiBmcm9tICcuLi9BdHRhY2htZW50L0Fzc2V0cy9XYXJuaW5nTm90aWZpY2F0aW9uSWNvbic7XG5cbmNvbnN0IENPTk5FQ1RJVklUWV9TVEFUVVNfREVCT1VOQ0UgPSA0MDA7XG5cbmNsYXNzIERlYm91bmNlZENvbm5lY3Rpdml0eVN0YXR1cyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGNoaWxkcmVuOiBwcm9wcy5jaGlsZHJlbixcbiAgICAgIHNpbmNlOiBEYXRlLm5vdygpXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgY29uc3QgeyBjaGlsZHJlbiwgaW50ZXJ2YWwgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBjaGlsZHJlbjogbmV4dENoaWxkcmVuLCBpbnRlcnZhbDogbmV4dEludGVydmFsIH0gPSBuZXh0UHJvcHM7XG4gICAgY29uc3QgeyBzaW5jZSB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIGlmIChuZXh0Q2hpbGRyZW4gIT09IGNoaWxkcmVuIHx8IG5leHRJbnRlcnZhbCAhPT0gaW50ZXJ2YWwpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuXG4gICAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSgoKSA9PiAoe1xuICAgICAgICAgIGNoaWxkcmVuOiBuZXh0Q2hpbGRyZW4sXG4gICAgICAgICAgc2luY2U6IERhdGUubm93KClcbiAgICAgICAgfSkpO1xuICAgICAgfSwgTWF0aC5tYXgoMCwgbmV4dEludGVydmFsIC0gRGF0ZS5ub3coKSArIHNpbmNlKSk7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBjaGlsZHJlbiB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIHJldHVybiB0eXBlb2YgY2hpbGRyZW4gPT09ICdmdW5jdGlvbicgPyBjaGlsZHJlbigpIDogZmFsc2U7XG4gIH1cbn1cblxuRGVib3VuY2VkQ29ubmVjdGl2aXR5U3RhdHVzLmRlZmF1bHRQcm9wcyA9IHtcbiAgY2hpbGRyZW46IHVuZGVmaW5lZFxufTtcblxuRGVib3VuY2VkQ29ubmVjdGl2aXR5U3RhdHVzLnByb3BUeXBlcyA9IHtcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5hbnksXG4gIGludGVydmFsOiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWRcbn07XG5cbmNvbnN0IGNvbm5lY3RDb25uZWN0aXZpdHlTdGF0dXMgPSAoLi4uc2VsZWN0b3JzKSA9PlxuICBjb25uZWN0VG9XZWJDaGF0KCh7IGNvbm5lY3Rpdml0eVN0YXR1cywgbGFuZ3VhZ2UgfSkgPT4gKHsgY29ubmVjdGl2aXR5U3RhdHVzLCBsYW5ndWFnZSB9KSwgLi4uc2VsZWN0b3JzKTtcblxuY29uc3QgQ29ubmVjdGl2aXR5U3RhdHVzID0gKHsgY29ubmVjdGl2aXR5U3RhdHVzLCBsYW5ndWFnZSwgc3R5bGVTZXQgfSkgPT4gKFxuICA8ZGl2IGFyaWEtbGl2ZT1cInBvbGl0ZVwiIHJvbGU9XCJzdGF0dXNcIj5cbiAgICA8RGVib3VuY2VkQ29ubmVjdGl2aXR5U3RhdHVzXG4gICAgICBpbnRlcnZhbD17XG4gICAgICAgIGNvbm5lY3Rpdml0eVN0YXR1cyA9PT0gJ3VuaW5pdGlhbGl6ZWQnIHx8IGNvbm5lY3Rpdml0eVN0YXR1cyA9PT0gJ2Vycm9yJyA/IDAgOiBDT05ORUNUSVZJVFlfU1RBVFVTX0RFQk9VTkNFXG4gICAgICB9XG4gICAgPlxuICAgICAgeygpID0+XG4gICAgICAgIGNvbm5lY3Rpdml0eVN0YXR1cyA9PT0gJ2Nvbm5lY3RpbmdzbG93JyA/IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17c3R5bGVTZXQud2FybmluZ05vdGlmaWNhdGlvbn0+XG4gICAgICAgICAgICA8V2FybmluZ05vdGlmaWNhdGlvbkljb24gLz5cbiAgICAgICAgICAgIHtsb2NhbGl6ZSgnU0xPV19DT05ORUNUSU9OX05PVElGSUNBVElPTicsIGxhbmd1YWdlKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IGNvbm5lY3Rpdml0eVN0YXR1cyA9PT0gJ2Vycm9yJyB8fCBjb25uZWN0aXZpdHlTdGF0dXMgPT09ICdub3Rjb25uZWN0ZWQnID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZVNldC5lcnJvck5vdGlmaWNhdGlvbn0+XG4gICAgICAgICAgICA8RXJyb3JOb3RpZmljYXRpb25JY29uIC8+XG4gICAgICAgICAgICB7bG9jYWxpemUoJ0ZBSUxFRF9DT05ORUNUSU9OX05PVElGSUNBVElPTicsIGxhbmd1YWdlKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IGNvbm5lY3Rpdml0eVN0YXR1cyA9PT0gJ3VuaW5pdGlhbGl6ZWQnID8gKFxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZVNldC5jb25uZWN0aXZpdHlOb3RpZmljYXRpb259PlxuICAgICAgICAgICAgPFNwaW5uZXJBbmltYXRpb24gLz5cbiAgICAgICAgICAgIHtsb2NhbGl6ZSgnSU5JVElBTF9DT05ORUNUSU9OX05PVElGSUNBVElPTicsIGxhbmd1YWdlKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IGNvbm5lY3Rpdml0eVN0YXR1cyA9PT0gJ3JlY29ubmVjdGluZycgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e3N0eWxlU2V0LmNvbm5lY3Rpdml0eU5vdGlmaWNhdGlvbn0+XG4gICAgICAgICAgICA8U3Bpbm5lckFuaW1hdGlvbiAvPlxuICAgICAgICAgICAge2xvY2FsaXplKCdJTlRFUlJVUFRFRF9DT05ORUNUSU9OX05PVElGSUNBVElPTicsIGxhbmd1YWdlKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IGNvbm5lY3Rpdml0eVN0YXR1cyA9PT0gJ3NhZ2FlcnJvcicgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e3N0eWxlU2V0LmVycm9yTm90aWZpY2F0aW9ufT5cbiAgICAgICAgICAgIDxFcnJvck5vdGlmaWNhdGlvbkljb24gLz5cbiAgICAgICAgICAgIHtsb2NhbGl6ZSgnUkVOREVSX0VSUk9SX05PVElGSUNBVElPTicsIGxhbmd1YWdlKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IChcbiAgICAgICAgICBjb25uZWN0aXZpdHlTdGF0dXMgPT09ICdyZWNvbm5lY3RlZCcgfHwgKGNvbm5lY3Rpdml0eVN0YXR1cyA9PT0gJ2Nvbm5lY3RlZCcgJiYgZmFsc2UpXG4gICAgICAgIClcbiAgICAgIH1cbiAgICA8L0RlYm91bmNlZENvbm5lY3Rpdml0eVN0YXR1cz5cbiAgPC9kaXY+XG4pO1xuXG5Db25uZWN0aXZpdHlTdGF0dXMucHJvcFR5cGVzID0ge1xuICBjb25uZWN0aXZpdHlTdGF0dXM6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgbGFuZ3VhZ2U6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgc3R5bGVTZXQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgY29ubmVjdGl2aXR5Tm90aWZpY2F0aW9uOiBQcm9wVHlwZXMuYW55LmlzUmVxdWlyZWQsXG4gICAgZXJyb3JOb3RpZmljYXRpb246IFByb3BUeXBlcy5hbnkuaXNSZXF1aXJlZCxcbiAgICB3YXJuaW5nTm90aWZpY2F0aW9uOiBQcm9wVHlwZXMuYW55LmlzUmVxdWlyZWRcbiAgfSkuaXNSZXF1aXJlZFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY29ubmVjdENvbm5lY3Rpdml0eVN0YXR1cygoeyBzdHlsZVNldCB9KSA9PiAoeyBzdHlsZVNldCB9KSkoQ29ubmVjdGl2aXR5U3RhdHVzKTtcbiJdfQ==